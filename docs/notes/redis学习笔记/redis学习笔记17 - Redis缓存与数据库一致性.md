---
title: redis学习笔记17 - Redis缓存与数据库一致性
date: 2022-06-24
category:
  - database
tag:
  - redis
prev: redis学习笔记16 - Redis持久化
next: redis学习笔记18 - 总结
---

## 十七、Redis 缓存与数据库一致性

### 17.1 实时同步

对强一直要求比较高的，应采用实时同步方案，即查询缓存查询不到在从 DB 查询，保存到缓存；更新缓存时，先更新数据库，在将缓存的设置过期（建议不要去更新缓存内容，直接设置缓存过期）。

@Cacheable: 查询时使用，注意 Long 类型需要转换为 String 类型，否则会抛异常

@CachePut: 跟新是使用，使用此注解，一定会从 DB 上查询数据

@CacheEvict: 删除时使用；

@Caching: 组合用法

### 17.2 异步队列

对于并发程度高的，可采用异步队列的方式同步，可采用 kafka 等消息中间件处理消息生产和消费。

### 17.3 使用阿里的同步工具 canal

### 17.4 采用 UDF 自定义函数的方式

面对 mysql 的 API 进行编程，利用触发器进行缓存同步，但 UDF 主要是 C/C++语言实现，学习成本高。
